<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Адміністрування - Спортивний центр</title>
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
    <%- include('blocks/header') -%>

    <div class="admin-container">
        <!-- Sidebar Navigation -->
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <h2>Адмін панель</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="#users" class="nav-item active" data-section="users">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    <span>Користувачі</span>
                </a>
                <a href="#chat-stats" class="nav-item" data-section="chat-stats">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span>Статистика чату</span>
                </a>
                <a href="#analytics" class="nav-item" data-section="analytics">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="20" x2="12" y2="10"></line>
                        <line x1="18" y1="20" x2="18" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="16"></line>
                    </svg>
                    <span>Аналітика</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Users Section -->
            <section id="users-section" class="content-section active">
                <div class="section-header">
                    <h1>Управління користувачами</h1>
                    <div class="search-box">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="user-search" placeholder="Пошук користувачів...">
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon user-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="total-users">0</div>
                            <div class="stat-label">Всього користувачів</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon trainer-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="8.5" cy="7" r="4"></circle>
                                <polyline points="17 11 19 13 23 9"></polyline>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="total-trainers">0</div>
                            <div class="stat-label">Тренерів</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon admin-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="total-admins">0</div>
                            <div class="stat-label">Адміністраторів</div>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Ім'я користувача</th>
                                <th>Email</th>
                                <th>Роль</th>
                                <th>Дата реєстрації</th>
                                <th>Дії</th>
                            </tr>
                        </thead>
                        <tbody id="users-table-body">
                            <!-- Filled by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <div class="pagination">
                    <button class="pagination-btn" id="prev-page" disabled>Попередня</button>
                    <span class="pagination-info">
                        Сторінка <span id="current-page">1</span> з <span id="total-pages">1</span>
                    </span>
                    <button class="pagination-btn" id="next-page">Наступна</button>
                </div>
            </section>

            <!-- Chat Statistics Section -->
            <section id="chat-stats-section" class="content-section">
                <div class="section-header">
                    <h1>Статистика чат-бота</h1>
                    <select id="stats-period" class="period-select">
                        <option value="today">Сьогодні</option>
                        <option value="week">Цей тиждень</option>
                        <option value="month">Цей місяць</option>
                    </select>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon chat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="total-sessions">0</div>
                            <div class="stat-label">Загальних сесій</div>
                            <div class="stat-change positive" id="sessions-change">+0%</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon message-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="total-messages">0</div>
                            <div class="stat-label">Повідомлень</div>
                            <div class="stat-change positive" id="messages-change">+0%</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon rating-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="avg-satisfaction">0.0</div>
                            <div class="stat-label">Середня оцінка</div>
                            <div class="stat-change positive" id="satisfaction-change">+0%</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Активність за період</h3>
                    <canvas id="activity-chart"></canvas>
                </div>

                <div class="two-column-grid">
                    <div class="info-card">
                        <h3>Популярні питання</h3>
                        <div id="popular-questions" class="questions-list">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>
                    <div class="info-card">
                        <h3>Останні відгуки</h3>
                        <div id="recent-feedback" class="feedback-list">
                            <!-- Filled by JavaScript -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Analytics Section -->
            <section id="analytics-section" class="content-section">
                <div class="section-header">
                    <h1>Детальна аналітика</h1>
                    <button class="export-btn" id="export-data">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Експортувати дані
                    </button>
                </div>

                <div class="insights-container">
                    <h3>Інсайти та рекомендації</h3>
                    <div id="insights-list" class="insights-list">
                        <!-- Filled by JavaScript -->
                    </div>
                </div>

                <div class="two-column-grid">
                    <div class="info-card">
                        <h3>Джерела відповідей</h3>
                        <canvas id="source-chart"></canvas>
                    </div>
                    <div class="info-card">
                        <h3>Активні сесії</h3>
                        <div class="active-sessions-value" id="active-sessions-count">0</div>
                        <div class="sessions-indicator">
                            <div class="indicator-dot active"></div>
                            <span>Користувачів онлайн зараз</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Role Change Modal -->
    <div id="role-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Зміна ролі користувача</h2>
                <button class="modal-close" id="close-modal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="user-info">
                    <strong>Користувач:</strong> <span id="modal-user-name"></span>
                </div>
                <div class="form-group">
                    <label for="new-role">Нова роль:</label>
                    <select id="new-role" class="role-select">
                        <option value="user">User (Користувач)</option>
                        <option value="trainer">Trainer (Тренер)</option>
                        <option value="admin">Admin (Адміністратор)</option>
                    </select>
                </div>
                <div class="role-descriptions">
                    <div class="role-desc">
                        <strong>User:</strong> Базові права, може переглядати тренування та записуватись
                    </div>
                    <div class="role-desc">
                        <strong>Trainer:</strong> Може створювати тренування та керувати своїми групами
                    </div>
                    <div class="role-desc">
                        <strong>Admin:</strong> Повний доступ до всіх функцій системи
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-role-change">Скасувати</button>
                <button class="btn btn-primary" id="confirm-role-change">Підтвердити</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="/js/admin.js"></script>
</body>
</html>